# Ava2
2024.10.31:
河北工大微机原理作业7（有bug版）
各个部分简要说明：
Instruction:实现各个指令功能，但是疑似存在bug，导致输出结果有误（比如mov函数实现就有bug）；
eu:实现解析汇编语言和执行指令；
cpu：包含各个寄存器和标志位，还包含初始化、设置标志位等功能；
biu:包含实现指令进入队列，以及从中取指的函数；
address:包含各个寻址方式，但是疑似存在bug，导致输出结果有误；
Chip2164:包含各个引脚的状态，包含初始化、写数据、读数据、设置引脚、清除引脚等功能；

tips:在开始讲解作业之前，请允许我向老师说一声抱歉，因为我这个代码大部分参考了gpt，比如再设计怎么剪除输入汇编程序的注释时，我是按我的想法直接让gap实现了这个功能，对应着呢就是trim_whitespace和parse_segment开头的这部分，具体的设计细节是由gpt完成的；还有一个原因，是因为我们组是在周六的时候才被抽到的，而那时候我们组进度最快的是我，那时的我才做到作业5的一点点内容，再加上我能力有限，所以导致这个作业有明显的赶工痕迹，而且导致了一系列bug；最后一个原因，就是这个代码是存在功能缺陷的，比如Instruction.c中mov的执行代码部分和address这部分存在bug，比如我上一条指令执行的是MOV AL, 15，然后输出没问题，到了下一条MOV [Num1], AL然后输出时发现AL的值变为0了，而且在处理数据段时Num1等值好像没有被定义。因为时间有限，所以我没能处理掉这些bug，导致作业6并没有真正意义上完成，也直接导致了这次的作业7注定不能用汇编语言来验证其输出正确与否。
---------------------------------------------------------------------------------------------------------------------------------------------------------------
2024.11.7:
改进了代码，主要体现在Instruction.c中mov函数的部分和address.c中查找地址的方法，使代码能支持立即寻址、直接寻址、寄存器间接寻址等寻址方式，增加了对MOV AX, DATA的特殊处理。
---------------------------------------------------------------------------------------------------------------------------------------------------------------
2024.11.13:
哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈，我终于改完bug了(T_T)，比如intruction.c从500多行代码加到1540行代码；然后现在这个代码能执行Test6中的测试用例了。不过值得一说的是，有些功能我实现的有点简陋，比如lea的寻址方式我只实现了case DIRECT的情况，如果后面有需要的话可以再添加更多的case；还有就是我只改进了Test6中所提到的指令，未被提到的暂时没有进行改进，我认为intruction.c还有很大的改进空间（要加更多的代码）；还有就是输入形如MOV SI, OFFSETStr1的指令时，“OFFSETStr1”中间一定不能有空格，否则会识别不了，这也算一个小bug吧；在实现堆栈段时，我把作业要求中的堆栈段从后移到前面了；对于标签，这个我实现的也比较简陋，只能识别名为“START”的标签，所以说这个也有很大的改进（加代码）空间；还有就是从这儿下载我的代码时可以忽略test5.c，因为里边的代码过于老旧了，需要大改才能运行，然而因为我懒，所以还没对这块进行改进- -；还有一些问题，就是输入汇编语言时不能加注释，如果加了一定，一定，一定会产生bug！！！
